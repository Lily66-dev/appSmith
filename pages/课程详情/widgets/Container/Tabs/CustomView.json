{
  "backgroundColor": "#FFFFFF",
  "borderColor": "#E0DEDE",
  "borderRadius": "0px",
  "borderWidth": "0",
  "bottomRow": 80,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "defaultModel": "{{utils}}",
  "dynamicBindingPathList": [
    {
      "key": "theme"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "defaultModel"
    }
  ],
  "dynamicHeight": "FIXED",
  "dynamicPropertyPathList": [],
  "dynamicTriggerPathList": [],
  "events": [],
  "isCanvas": false,
  "isLoading": false,
  "isSearchWildcard": true,
  "isVisible": true,
  "key": "4lu8homunf",
  "leftColumn": 0,
  "maxDynamicHeight": 57,
  "minDynamicHeight": 52,
  "mobileBottomRow": 36,
  "mobileLeftColumn": 0,
  "mobileRightColumn": 6,
  "mobileTopRow": 6,
  "needsErrorInfo": false,
  "originalBottomRow": 80,
  "originalTopRow": 27,
  "parentColumnSpace": 16.489013671875,
  "parentId": "kq9fwn5mdt",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "rightColumn": 63,
  "shouldScrollContents": true,
  "srcDoc": {
    "css": "@charset \"UTF-8\";\n/* åº”ç”¨å®¹å™¨ */\n.app-container {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  font-family: Arial, sans-serif;\n  background-color: #f5f5f5;\n  padding: 16px;\n  box-sizing: border-box;\n}\n\n/* ä¸»å†…å®¹åŒºåŸŸ */\n.app-main {\n  display: flex;\n  flex: 1;\n  gap: 16px;\n  height: 100%;\n}\n\n.chapter-tree-page {\n  height: 100vh;\n}\n\n/* ç« èŠ‚é¢æ¿ */\n.chapter-panel {\n  width: 66.7%;\n  background-color: #fff;\n  border-radius: 2px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  display: flex;\n  flex-direction: column;\n  transition: width 0.3s;\n}\n\n/* å…¨å®½ç« èŠ‚é¢æ¿ */\n.chapter-panel.full-width {\n  width: 100%;\n}\n\n/* é¢æ¿å¤´éƒ¨ */\n.panel-header {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  padding: 16px 16px 0 16px;\n  height: 30px;\n  line-height: 30px;\n}\n\n/* é¢æ¿æ ‡é¢˜ */\n.panel-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n  color: rgba(0, 0, 0, 0.85);\n}\n\n/* æ·»åŠ ä¸€çº§ç›®å½•æŒ‰é’® */\n.add-root-button {\n  padding: 5px 12px;\n  background-color: #fff;\n  color: #3949ab;\n  border: 1px solid #3949ab;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 13px;\n  height: 28px;\n  line-height: 18px;\n}\n\n.add-root-button:hover {\n  background-color: rgba(57, 73, 171, 0.062745098);\n}\n\n/* ç« èŠ‚æ ‘å®¹å™¨ */\n.chapter-tree-container {\n  flex: 1;\n  overflow-y: auto;\n  padding: 16px;\n}\n\n/* ç¼–è¾‘å™¨é¢æ¿ */\n.editor-panel {\n  flex: 1;\n  background-color: white;\n  border-radius: 2px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n}\n\n/* ç©ºç¼–è¾‘å™¨çŠ¶æ€ */\n.empty-editor {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  color: #888;\n}\n\n/* å–æ¶ˆæŒ‰é’® */\n.cancel-button {\n  padding: 6px 15px;\n  background-color: #f5f5f5;\n  color: rgba(0, 0, 0, 0.65);\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  height: 32px;\n  line-height: 20px;\n}\n\n.cancel-button:hover {\n  color: #3949ab;\n  border-color: #3949ab;\n}\n\n/* æ ‡é¢˜æ ·å¼ */\nh2 {\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 16px;\n  margin-bottom: 16px;\n  font-weight: 500;\n}\n\n/* é¢æ¿æ“ä½œåŒºåŸŸ */\n.panel-actions {\n  display: flex;\n  gap: 8px;\n}\n\n/* æ¨¡å¼åˆ‡æ¢æŒ‰é’® */\n.mode-toggle-button {\n  padding: 5px 12px;\n  background-color: #f5f5f5;\n  color: rgba(0, 0, 0, 0.65);\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 13px;\n  height: 28px;\n  line-height: 18px;\n}\n\n.mode-toggle-button:hover {\n  color: #3949ab;\n  border-color: #3949ab;\n}\n\n/* ç« èŠ‚ç¼–è¾‘å™¨ */\n.chapter-editor {\n  padding: 20px;\n  background-color: white;\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 40px); /* å‡å»å†…è¾¹è· */\n}\n\n/* ç¼–è¾‘å™¨æ ‡é¢˜ */\n.editor-header {\n  margin-bottom: 24px;\n  border-bottom: 1px solid #f0f0f0;\n  padding-bottom: 16px;\n}\n\n.editor-header h2 {\n  margin: 0;\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 16px;\n  font-weight: 500;\n}\n\n/* ç¼–è¾‘å™¨è¡¨å• */\n.editor-form {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  overflow: hidden; /* é˜²æ­¢å†…å®¹æº¢å‡º */\n}\n\n/* è¡¨å•å†…å®¹åŒºåŸŸ */\n.form-content {\n  flex: 1;\n  overflow-y: auto; /* åªæœ‰å†…å®¹åŒºæ»šåŠ¨ */\n  margin-bottom: 16px; /* ç»™åº•éƒ¨æŒ‰é’®ç•™ç©ºé—´ */\n}\n\n/* è¡¨å•ç»„ */\n.form-group {\n  width: 100%;\n  margin-bottom: 24px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: normal;\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 14px;\n  word-break: break-all;\n}\n\n/* è¾“å…¥æ¡†æ ·å¼ */\n.form-control {\n  width: calc(100% - 32px);\n  padding: 4px 11px;\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  font-size: 14px;\n  height: 32px;\n  line-height: 1.5;\n}\n\n.form-control:focus {\n  border-color: #40a9ff;\n  outline: none;\n  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);\n}\n\n/* é€‰æ‹©æ¡†åˆ—è¡¨ */\n.checkbox-list {\n  max-height: 300px;\n  overflow-y: auto;\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  padding: 8px 12px;\n}\n\n/* é€‰æ‹©æ¡†é¡¹ç›® */\n.checkbox-item {\n  padding: 8px 0;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.checkbox-item:last-child {\n  border-bottom: none;\n}\n\n/* é€‰æ‹©æ¡†æ ‡ç­¾ */\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.checkbox-label input {\n  margin-right: 8px;\n}\n\n/* è¡¨å•æ“ä½œåŒºåŸŸ */\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 8px;\n  /* ç§»é™¤ç»å¯¹å®šä½ï¼Œä½¿ç”¨å¸¸è§„æµå¸ƒå±€ */\n  margin-top: auto; /* æ¨åˆ°åº•éƒ¨ */\n}\n\n/* ä¿å­˜æŒ‰é’® */\n.save-button {\n  padding: 0 15px;\n  background-color: #3949ab;\n  color: white;\n  border: none;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  height: 32px;\n  line-height: 32px;\n}\n\n.save-button:hover {\n  background-color: #5c6bc0;\n}\n\n/* å–æ¶ˆæŒ‰é’® */\n.cancel-button {\n  padding: 0 15px;\n  background-color: #fff;\n  color: rgba(0, 0, 0, 0.65);\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  height: 32px;\n  line-height: 30px;\n}\n\n.cancel-button:hover {\n  color: #3949ab;\n  border-color: #3949ab;\n}\n\n/* ç« èŠ‚é¡¹ç›® */\n.chapter-item {\n  padding: 12px 15px;\n  background-color: white;\n  border: 1px solid #f0f0f0;\n  border-radius: 2px;\n  cursor: pointer;\n  transition: all 0.2s;\n  margin-bottom: 8px;\n}\n\n.chapter-item:hover {\n  background-color: #f9f9f9;\n}\n\n.chapter-item.selected {\n  background-color: #e6f7ff;\n  border-left: 3px solid #1890ff;\n}\n\n/* ç« èŠ‚å†…å®¹ */\n.chapter-content {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n/* ç« èŠ‚æ ‡é¢˜ */\n.chapter-title {\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 14px;\n}\n\n/* ç« èŠ‚æ“ä½œæŒ‰é’® */\n.chapter-actions {\n  display: flex;\n  gap: 8px;\n}\n\n/* ç« èŠ‚èµ„æºåˆ—è¡¨ */\n.chapter-resources {\n  margin-left: 30px;\n  padding: 5px 0;\n}\n\n/* èµ„æºåˆ—è¡¨ */\n.resource-list {\n  margin-bottom: 5px;\n}\n\n/* èµ„æºé¡¹ç›® */\n.resource-item {\n  padding: 6px 10px;\n  background-color: #f9f9f9;\n  border-radius: 3px;\n  margin-bottom: 4px;\n  font-size: 12px;\n  display: flex;\n  align-items: center;\n  color: #666;\n  transition: all 0.2s;\n  position: relative;\n  padding-left: 6px; /* ä¸ºæ ‡è®°ç•™å‡ºç©ºé—´ */\n}\n\n.resource-item:hover {\n  background-color: #f0f0f0;\n}\n\n/* èµ„æºç±»å‹æ ‡è®° */\n.resource-type-marker {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 4px;\n  height: 100%;\n  border-radius: 2px 0 0 2px;\n}\n\n/* èµ„æºæ ‡é¢˜ */\n.resource-title {\n  margin-left: 8px;\n  font-size: 12px;\n  line-height: 1.5;\n}\n\n/* ç§»é™¤ä¹‹å‰çš„æ ·å¼ */\n.attachment-item,\n.quiz-item {\n  border-left: none;\n}\n\n/* è¯¾ä»¶æ ‡ç­¾æ ·å¼ */\n.attachment-item::before {\n  content: \"è¯¾ä»¶\";\n  display: inline-block;\n  background-color: #22c55e;\n  color: #fff;\n  padding: 1px 6px;\n  border-radius: 2px;\n  font-size: 11px;\n  margin-right: 6px;\n  border: 1px solid transparent;\n  white-space: nowrap;\n}\n\n/* è€ƒé¢˜æ ‡ç­¾æ ·å¼ */\n.quiz-item::before {\n  content: \"è€ƒè¯•\";\n  display: inline-block;\n  background-color: #eba400;\n  color: #fff;\n  padding: 1px 6px;\n  border-radius: 2px;\n  font-size: 11px;\n  margin-right: 6px;\n  border: 1px solid transparent;\n}\n\n/* ä¸€çº§ç« èŠ‚ */\n.level-1 {\n  font-weight: 500;\n  background-color: #fafafa;\n  border-left: 3px solid #d9d9d9;\n}\n\n.level-1.selected {\n  border-left: 3px solid #1890ff;\n}\n\n/* äºŒçº§ç« èŠ‚ */\n.level-2 {\n  font-weight: normal;\n  background-color: #ffffff;\n  padding-left: 20px;\n  margin-left: 15px;\n  border-left: 3px solid #f0f0f0;\n}\n\n.level-2.selected {\n  border-left: 3px solid #52c41a;\n}\n\n/* æ·»åŠ å­ç« èŠ‚æŒ‰é’® */\n.add-sub-button {\n  background-color: #3949ab;\n  color: white;\n  border: none;\n  border-radius: 2px;\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.add-sub-button:hover {\n  background-color: #5c6bc0;\n}\n\n/* åˆ é™¤æŒ‰é’® */\n.delete-button {\n  background-color: #f5f5f5;\n  color: rgba(0, 0, 0, 0.65);\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  font-size: 12px;\n}\n\n.delete-button:hover {\n  color: #ff4d4f;\n  border-color: #ff4d4f;\n}\n\n/* ä¸€çº§ç« èŠ‚çš„èµ„æºåˆ—è¡¨æ ·å¼è°ƒæ•´ */\n.level-1-resources {\n  margin-left: 10px;\n  border-left: 3px solid #d9d9d9;\n  padding-left: 20px;\n}\n\n/* åªè¯»æ¨¡å¼ä¸‹çš„èµ„æºæ ·å¼ */\n.read-only-resources .resource-item {\n  cursor: default;\n}\n\n.read-only-resources .resource-item:hover {\n  background-color: #f9f9f9; /* ä¿æŒåŸèƒŒæ™¯è‰²ï¼Œä¸æ”¹å˜ */\n}\n\n/* ç« èŠ‚æ ‘æ ·å¼ */\n.chapter-tree {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n/* ç« èŠ‚ç»„æ ·å¼ */\n.chapter-group {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 5px;\n}\n\n/* å­ç« èŠ‚åŒºåŸŸæ ·å¼ */\n.sub-chapters {\n  margin-left: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding-top: 5px;\n  border-left: 1px dashed #d9d9d9;\n  margin-left: 10px;\n  padding-left: 20px;\n}\n\n/* åªè¯»æ¨¡å¼æ ·å¼ */\n.chapter-tree.read-only .chapter-item {\n  cursor: default;\n}\n\n.chapter-tree.read-only .chapter-item:hover {\n  background-color: transparent;\n}\n\n.chapter-item.read-only {\n  cursor: default;\n}\n\n.chapter-item.read-only:hover {\n  background-color: transparent;\n}\n\n.chapter-item.read-only.selected {\n  background-color: transparent;\n  font-weight: normal;\n  color: inherit;\n}\n\n.confirm-dialog-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.confirm-dialog {\n  background-color: white;\n  padding: 24px;\n  border-radius: 2px;\n  width: 320px;\n  box-shadow: 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08);\n}\n\n.confirm-dialog-title {\n  margin: 0 0 16px 0;\n  font-size: 16px;\n  color: rgba(0, 0, 0, 0.85);\n  font-weight: 500;\n}\n\n.confirm-dialog-message {\n  margin-bottom: 24px;\n  color: rgba(0, 0, 0, 0.65);\n  font-size: 14px;\n}\n\n.confirm-dialog-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 8px;\n}\n\n.confirm-dialog-cancel {\n  padding: 0 15px;\n  height: 32px;\n  line-height: 30px;\n  background-color: white;\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.65);\n}\n\n.confirm-dialog-cancel:hover {\n  color: #3949ab;\n  border-color: #3949ab;\n}\n\n.confirm-dialog-confirm {\n  padding: 0 15px;\n  height: 32px;\n  line-height: 32px;\n  background-color: #3949ab;\n  border: none;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  color: white;\n}\n\n.confirm-dialog-confirm:hover {\n  background-color: #5c6bc0;\n}\n\n/* ç¦ç”¨çš„å¤šé€‰æ¡†æ ‡ç­¾æ ·å¼ */\n.checkbox-label.disabled {\n  color: #999;\n  cursor: not-allowed;\n}\n\n/* å·²è¢«ä½¿ç”¨æ ‡è®°çš„æ ·å¼ */\n.resource-used-mark {\n  margin-left: 5px;\n  font-size: 12px;\n  color: #ff6b6b;\n  font-style: italic;\n}\n\n/* ç« èŠ‚æ ‘ç©ºçŠ¶æ€æ ·å¼ */\n.chapter-tree-empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 0;\n  color: #999;\n  text-align: center;\n}\n\n.empty-state-icon {\n  font-size: 48px;\n  margin-bottom: 16px;\n  color: #d9d9d9;\n}\n\n.empty-state-text {\n  font-size: 16px;\n  margin-bottom: 8px;\n  color: #666;\n}\n\n.empty-state-hint {\n  font-size: 14px;\n  color: #999;\n}\n\n/* èµ„æºåˆ—è¡¨ç©ºçŠ¶æ€æ ·å¼ */\n.resource-empty-state {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 20px 0;\n  color: #999;\n  font-size: 14px;\n  background-color: #fafafa;\n  border-radius: 3px;\n}",
    "html": "<!-- no need to write html, head, body tags, it is handled by the widget -->\n<div id=\"root\"></div>\n",
    "js": "import React, { useState, useEffect } from \"https://esm.sh/react@18.2.0\";\nimport ReactDOM from \"https://esm.sh/react-dom@18.2.0\";\n\n// æ¨¡æ‹Ÿçš„å¯é€‰è€ƒé¢˜æ•°æ®\nconst AVAILABLE_QUIZZES = [{\n  id: 1,\n  name: \"è€ƒé¢˜1ï¼šJavaåŸºç¡€çŸ¥è¯†æµ‹è¯•\"\n}, {\n  id: 2,\n  name: \"è€ƒé¢˜2ï¼šé¢å‘å¯¹è±¡æ¦‚å¿µç†è§£\"\n}, {\n  id: 3,\n  name: \"è€ƒé¢˜3ï¼šJavaè¯­æ³•ç»ƒä¹ \"\n}, {\n  id: 4,\n  name: \"è€ƒé¢˜4ï¼šç¼–ç¨‹å®è·µé¢˜\"\n}, {\n  id: 5,\n  name: \"è€ƒé¢˜5ï¼šç»¼åˆåº”ç”¨èƒ½åŠ›æµ‹è¯•\"\n}];\nfunction ConfirmDialog({\n  isOpen,\n  name,\n  message,\n  onConfirm,\n  onCancel\n}) {\n  if (!isOpen) return null;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"confirm-dialog-overlay\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"confirm-dialog\"\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"confirm-dialog-title\"\n  }, name), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"confirm-dialog-message\"\n  }, message), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"confirm-dialog-actions\"\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"confirm-dialog-cancel\",\n    onClick: onCancel\n  }, \"\\u53D6\\u6D88\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"confirm-dialog-confirm\",\n    onClick: onConfirm\n  }, \"\\u786E\\u5B9A\"))));\n}\n\n// ç« èŠ‚é¡¹ç»„ä»¶\nfunction ChapterItem({\n  chapter,\n  selected,\n  onSelect,\n  onAddSubChapter,\n  onDelete,\n  level,\n  readOnly = false // æ·»åŠ åªè¯»æ¨¡å¼å‚æ•°ï¼Œé»˜è®¤ä¸ºfalse\n}) {\n  // æ·»åŠ çŠ¶æ€æ§åˆ¶ç¡®è®¤å¯¹è¯æ¡†æ˜¾ç¤º\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [courseWare, setCourseWare] = useState(appsmith?.model?.courseWare ?? []);\n\n  // å¤„ç†ç« èŠ‚é€‰æ‹©\n  const handleSelect = () => {\n    if (!readOnly) {\n      onSelect(chapter.id);\n    }\n  };\n\n  // å¤„ç†æ·»åŠ å­ç« èŠ‚\n  const handleAddSubChapter = e => {\n    e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œé¿å…è§¦å‘ç« èŠ‚é€‰æ‹©\n    onAddSubChapter(chapter.id);\n  };\n\n  // å¤„ç†åˆ é™¤æŒ‰é’®ç‚¹å‡»\n  const handleDeleteClick = e => {\n    e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡\n    setShowDeleteConfirm(true); // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†\n  };\n\n  // ç¡®è®¤åˆ é™¤\n  const confirmDelete = () => {\n    setShowDeleteConfirm(false);\n    onDelete(chapter.id);\n  };\n\n  // å–æ¶ˆåˆ é™¤\n  const cancelDelete = () => {\n    setShowDeleteConfirm(false);\n  };\n\n  // æ ¼å¼åŒ–ç« èŠ‚æ ‡é¢˜\n  const formatTitle = () => {\n    // å¯¹äºä¸€çº§ç« èŠ‚ï¼Œæ ¼å¼ä¸º\"ç¬¬Xç« \"\n    if (level === 1) {\n      return `ç¬¬${chapter.sort}ç«  ${chapter.name}`;\n    }\n\n    // å¯¹äºäºŒçº§ç« èŠ‚ï¼Œæ ¼å¼ä¸º\"X.Y\"\n    return `${chapter.id} ${chapter.name}`;\n  };\n\n  // è¾…åŠ©å‡½æ•°ï¼šæ ¹æ®IDæŸ¥æ‰¾å¯¹åº”çš„è¯¾ä»¶åç§°\n  const getAttachmentName = id => {\n    const attachment = courseWare.find(a => a.id === id);\n    return attachment ? attachment.name : `æœªçŸ¥è¯¾ä»¶(${id})`;\n  };\n\n  // è¾…åŠ©å‡½æ•°ï¼šæ ¹æ®IDæŸ¥æ‰¾å¯¹åº”çš„è€ƒé¢˜åç§°\n  const getQuizName = id => {\n    const quiz = AVAILABLE_QUIZZES.find(q => q.id === id);\n    return quiz ? quiz.name : `æœªçŸ¥è€ƒé¢˜(${id})`;\n  };\n\n  // æ£€æŸ¥æ˜¯å¦æœ‰å…³è”çš„è¯¾ä»¶æˆ–è€ƒé¢˜\n  const hasAttachments = chapter.attachments && chapter.attachments.length > 0;\n  const hasQuizzes = chapter.quizzes && chapter.quizzes.length > 0;\n  useEffect(() => {\n    appsmith.onModelChange((model, prevModel) => {\n      if (JSON.stringify(model.courseWare) !== JSON.stringify(prevModel?.courseWare)) {\n        setCourseWare(model.courseWare ?? []);\n      }\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"div\", {\n    className: `chapter-item ${selected ? 'selected' : ''} level-${level} ${readOnly ? 'read-only' : ''}`,\n    onClick: handleSelect\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chapter-content\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chapter-name\"\n  }, chapter.displayTitle || formatTitle()), !readOnly && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chapter-actions\"\n  }, level === 1 && /*#__PURE__*/React.createElement(\"button\", {\n    className: \"add-sub-button\",\n    onClick: handleAddSubChapter,\n    title: \"\\u6DFB\\u52A0\\u4E8C\\u7EA7\\u76EE\\u5F55\"\n  }, \"+\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"delete-button\",\n    onClick: handleDeleteClick,\n    title: \"\\u5220\\u9664\\u7AE0\\u8282\"\n  }, \"\\xD7\")))), (hasAttachments || hasQuizzes) && /*#__PURE__*/React.createElement(\"div\", {\n    className: `chapter-resources ${level === 1 ? 'level-1-resources' : ''} ${readOnly ? 'read-only-resources' : ''}`\n  }, hasAttachments && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"resource-list\"\n  }, chapter.attachments.map((attachmentId, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: `att-${index}`,\n    className: \"resource-item attachment-item\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"resource-type-marker file-marker\"\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"resource-title\"\n  }, getAttachmentName(attachmentId))))), hasQuizzes && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"resource-list\"\n  }, chapter.quizzes.map((quizId, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: `quiz-${index}`,\n    className: \"resource-item quiz-item\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"resource-type-marker quiz-marker\"\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"resource-title\"\n  }, getQuizName(quizId)))))), /*#__PURE__*/React.createElement(ConfirmDialog, {\n    isOpen: showDeleteConfirm,\n    title: \"\\u5220\\u9664\\u786E\\u8BA4\",\n    message: `ç¡®å®šè¦åˆ é™¤\"${chapter.name}\"ç« èŠ‚å—ï¼Ÿ`,\n    onConfirm: confirmDelete,\n    onCancel: cancelDelete\n  }));\n}\n\n// ç« èŠ‚æ ‘ç»„ä»¶\nfunction ChapterTree({\n  chapters,\n  selectedChapterId,\n  onSelectChapter,\n  onAddSubChapter,\n  onDeleteChapter,\n  readOnly = false // æ·»åŠ åªè¯»æ¨¡å¼å‚æ•°ï¼Œé»˜è®¤ä¸ºfalse\n}) {\n  // è·å–é¡¶çº§ç« èŠ‚\n  const rootChapters = chapters.filter(chapter => !chapter.parentId);\n\n  // æ’åºé¡¶çº§ç« èŠ‚\n  const sortedRootChapters = [...rootChapters].sort((a, b) => a.sort - b.sort);\n\n  // è·å–å­ç« èŠ‚\n  const getChildChapters = parentId => {\n    return chapters.filter(chapter => chapter.parentId === parentId).sort((a, b) => {\n      const aOrder = parseInt(a.id.split('.')[1]);\n      const bOrder = parseInt(b.id.split('.')[1]);\n      return aOrder - bOrder;\n    });\n  };\n\n  // å¦‚æœæ²¡æœ‰ä¸€çº§ç« èŠ‚ï¼Œæ˜¾ç¤ºç©ºçŠ¶æ€\n  if (sortedRootChapters.length === 0) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chapter-tree-empty-state\"\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"empty-state-icon\"\n    }, \"\\uD83D\\uDCDA\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"empty-state-text\"\n    }, \"\\u6682\\u65E0\\u7AE0\\u8282\\u6570\\u636E\"), !readOnly && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"empty-state-hint\"\n    }, \"\\u70B9\\u51FB\\\"\\u6DFB\\u52A0\\u4E00\\u7EA7\\u76EE\\u5F55\\\"\\u6309\\u94AE\\u521B\\u5EFA\\u7AE0\\u8282\"));\n  }\n\n  // è‡ªå®šä¹‰ç« èŠ‚æ ‡é¢˜æ ¼å¼åŒ–å‡½æ•°\n  const formatChapterTitle = (chapter, index, parentIndex = null) => {\n    if (!parentIndex) {\n      // ä¸€çº§ç« èŠ‚ï¼šç¬¬Xç«  åç§°\n      return `ç¬¬${index}ç«  ${chapter.name}`;\n    } else {\n      // äºŒçº§ç« èŠ‚ï¼šX.Y åç§°\n      return `${parentIndex}.${index} ${chapter.name}`;\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: `chapter-tree ${readOnly ? 'read-only' : ''}`\n  }, sortedRootChapters.map((rootChapter, rootIndex) => {\n    const parentIndex = rootIndex + 1; // ä»1å¼€å§‹çš„çˆ¶ç« èŠ‚ç´¢å¼•\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: rootChapter.id,\n      className: \"chapter-root\"\n    }, /*#__PURE__*/React.createElement(ChapterItem, {\n      chapter: {\n        ...rootChapter,\n        displayTitle: formatChapterTitle(rootChapter, parentIndex)\n      },\n      selected: selectedChapterId === rootChapter.id,\n      onSelect: readOnly ? () => {} : onSelectChapter,\n      onAddSubChapter: onAddSubChapter,\n      onDelete: onDeleteChapter,\n      level: 1,\n      readOnly: readOnly\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chapter-children\"\n    }, getChildChapters(rootChapter.id).map((childChapter, childIndex) => /*#__PURE__*/React.createElement(ChapterItem, {\n      key: childChapter.id,\n      chapter: {\n        ...childChapter,\n        displayTitle: formatChapterTitle(childChapter, childIndex + 1, parentIndex)\n      },\n      selected: selectedChapterId === childChapter.id,\n      onSelect: readOnly ? () => {} : onSelectChapter,\n      onAddSubChapter: onAddSubChapter,\n      onDelete: onDeleteChapter,\n      level: 2,\n      readOnly: readOnly\n    }))));\n  }));\n}\nfunction ChapterTreePage() {\n  // ç« èŠ‚æ•°æ®çŠ¶æ€\n  const [chapters, setChapters] = useState(appsmith?.model?.chapters ?? []);\n\n  // å½“å‰é€‰ä¸­çš„ç« èŠ‚ID\n  const [selectedChapterId, setSelectedChapterId] = useState(null);\n  // æ˜¯å¦æ˜¾ç¤ºç¼–è¾‘å™¨\n  const [showEditor, setShowEditor] = useState(false);\n  useEffect(() => {\n    appsmith.onModelChange((model, prevModel) => {\n      if (JSON.stringify(model.chapters) !== JSON.stringify(prevModel?.chapters)) {\n        setChapters(model.chapters ?? []);\n      }\n    });\n  }, []);\n\n  // æ·»åŠ æ–°ç« èŠ‚\n  const addChapter = (parentId = null) => {\n    // å¦‚æœæ˜¯æ·»åŠ ä¸€çº§ç« èŠ‚\n    if (parentId === null) {\n      // è·å–å½“å‰æœ€å¤§çš„ä¸€çº§ç« èŠ‚æ•°é‡\n      const rootChapters = chapters.filter(c => c.parentId === null);\n      const newOrder = rootChapters.length + 1;\n      const newChapter = {\n        id: newOrder.toString(),\n        name: 'æ–°ç« èŠ‚åç§°',\n        sort: newOrder,\n        parentId: null,\n        attachments: [],\n        // ç¡®ä¿åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„\n        quizzes: [] // ç¡®ä¿åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„\n      };\n      setChapters([...chapters, newChapter]);\n      appsmith.triggerEvent(\"handleSaveChapter\", {\n        chapters: [...chapters, newChapter]\n      });\n      setSelectedChapterId(newChapter.id);\n      // æ˜¾ç¤ºç¼–è¾‘å™¨\n      setShowEditor(true);\n    } else {\n      // å¦‚æœæ˜¯æ·»åŠ äºŒçº§ç« èŠ‚ï¼ˆå­ç« èŠ‚ï¼‰\n      // è·å–çˆ¶ç« èŠ‚\n      const parentChapter = chapters.find(c => c.id === parentId);\n      if (!parentChapter) return;\n\n      // è·å–è¯¥çˆ¶ç« èŠ‚ä¸‹çš„æ‰€æœ‰å­ç« èŠ‚\n      const childChapters = chapters.filter(c => c.parentId === parentId);\n      // è®¡ç®—æ–°å­ç« èŠ‚çš„é¡ºåº\n      const newChildOrder = childChapters.length + 1;\n      // åˆ›å»ºæ–°å­ç« èŠ‚\n      const newChildChapter = {\n        id: `${parentId}.${newChildOrder}`,\n        name: 'æ–°å°èŠ‚åç§°',\n        sort: newChildOrder,\n        parentId: parentId,\n        attachments: [],\n        // ç¡®ä¿åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„\n        quizzes: [] // ç¡®ä¿åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„\n      };\n      setChapters([...chapters, newChildChapter]);\n      appsmith.triggerEvent(\"handleSaveChapter\", {\n        chapters: [...chapters, newChildChapter]\n      });\n      setSelectedChapterId(newChildChapter.id);\n      // æ˜¾ç¤ºç¼–è¾‘å™¨\n      setShowEditor(true);\n    }\n  };\n\n  // åˆ é™¤ç« èŠ‚\n  const deleteChapter = chapterId => {\n    // æ‰¾åˆ°è¦åˆ é™¤çš„ç« èŠ‚\n    const chapterToDelete = chapters.find(c => c.id === chapterId);\n    if (!chapterToDelete) return;\n\n    // å¦‚æœæ˜¯ä¸€çº§ç« èŠ‚ï¼ŒåŒæ—¶åˆ é™¤å…¶æ‰€æœ‰å­ç« èŠ‚\n    if (chapterToDelete.parentId === null) {\n      const updatedChapters = chapters.filter(c => c.id !== chapterId && c.parentId !== chapterId);\n\n      // é‡æ–°æ’åºå‰©ä½™çš„ä¸€çº§ç« èŠ‚\n      const rootChapters = updatedChapters.filter(c => c.parentId === null).sort((a, b) => a.sort - b.sort);\n\n      // æ›´æ–°ä¸€çº§ç« èŠ‚çš„IDå’Œé¡ºåº\n      rootChapters.forEach((chapter, index) => {\n        const newOrder = index + 1;\n        const oldId = chapter.id;\n        chapter.id = newOrder.toString();\n        chapter.sort = newOrder;\n\n        // åŒæ—¶æ›´æ–°è¯¥ç« èŠ‚ä¸‹æ‰€æœ‰å­ç« èŠ‚çš„ID\n        updatedChapters.filter(c => c.parentId === oldId).forEach(childChapter => {\n          childChapter.parentId = chapter.id;\n          childChapter.id = `${chapter.id}.${childChapter.sort}`;\n        });\n      });\n      setChapters(updatedChapters);\n      appsmith.triggerEvent(\"handleSaveChapter\", {\n        chapters: updatedChapters\n      });\n\n      // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰é€‰ä¸­çš„ç« èŠ‚ï¼Œå–æ¶ˆé€‰ä¸­å¹¶éšè—ç¼–è¾‘å™¨\n      if (selectedChapterId === chapterId) {\n        setSelectedChapterId(null);\n        setShowEditor(false);\n      }\n    } else {\n      // å¦‚æœæ˜¯äºŒçº§ç« èŠ‚ï¼Œåªåˆ é™¤è¯¥ç« èŠ‚\n      const parentId = chapterToDelete.parentId;\n      const updatedChapters = chapters.filter(c => c.id !== chapterId);\n\n      // é‡æ–°æ’åºåŒä¸€çˆ¶ç« èŠ‚ä¸‹çš„æ‰€æœ‰å­ç« èŠ‚\n      const siblingChapters = updatedChapters.filter(c => c.parentId === parentId).sort((a, b) => a.sort - b.sort);\n\n      // æ›´æ–°å­ç« èŠ‚çš„IDå’Œé¡ºåº\n      siblingChapters.forEach((chapter, index) => {\n        const newOrder = index + 1;\n        chapter.id = `${parentId}.${newOrder}`;\n        chapter.sort = newOrder;\n      });\n      setChapters(updatedChapters);\n      appsmith.triggerEvent(\"handleSaveChapter\", {\n        chapters: updatedChapters\n      });\n      // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰é€‰ä¸­çš„ç« èŠ‚ï¼Œé€‰æ‹©çˆ¶ç« èŠ‚\n      if (selectedChapterId === chapterId) {\n        setSelectedChapterId(parentId);\n      }\n    }\n  };\n\n  // é€‰ä¸­ç« èŠ‚\n  const selectChapter = chapterId => {\n    setSelectedChapterId(chapterId);\n    setShowEditor(true); // é€‰ä¸­ç« èŠ‚æ—¶æ˜¾ç¤ºç¼–è¾‘å™¨\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chapter-tree-page\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"app-main\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `chapter-panel ${!showEditor ? 'full-width' : ''}`\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chapter-tree-container\"\n  }, /*#__PURE__*/React.createElement(ChapterTree, {\n    chapters: chapters,\n    selectedChapterId: selectedChapterId,\n    onSelectChapter: selectChapter,\n    onAddSubChapter: addChapter,\n    onDeleteChapter: deleteChapter,\n    readOnly: true // æ ¹æ®æ¨¡å¼è®¾ç½®æ˜¯å¦åªè¯»\n  })))));\n}\nappsmith.onReady(() => {\n  /*\n       * This handler function will get called when parent application is ready.\n       * Initialize your component here\n       * more info - https://docs.appsmith.com/reference/widgets/custom#onready\n       */\n  ReactDOM.render(/*#__PURE__*/React.createElement(ChapterTreePage, null), document.getElementById(\"root\"));\n});"
  },
  "theme": "{{appsmith.theme}}",
  "topRow": 27,
  "type": "CUSTOM_WIDGET",
  "uncompiledSrcDoc": {
    "css": "/* åº”ç”¨å®¹å™¨ */\n.app-container {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  font-family: Arial, sans-serif;\n  background-color: #f5f5f5;\n  padding: 16px;\n  box-sizing: border-box;\n}\n\n/* ä¸»å†…å®¹åŒºåŸŸ */\n.app-main {\n  display: flex;\n  flex: 1;\n  gap: 16px;\n  height: 100%;\n}\n\n.chapter-tree-page {\n  height: 100vh;\n}\n\n/* ç« èŠ‚é¢æ¿ */\n.chapter-panel {\n  width: 66.7%;\n  background-color: #fff;\n  border-radius: 2px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  display: flex;\n  flex-direction: column;\n  transition: width 0.3s;\n}\n\n/* å…¨å®½ç« èŠ‚é¢æ¿ */\n.chapter-panel.full-width {\n  width: 100%;\n}\n\n/* é¢æ¿å¤´éƒ¨ */\n.panel-header {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  padding: 16px 16px 0 16px;\n  height: 30px;\n  line-height: 30px;\n}\n\n/* é¢æ¿æ ‡é¢˜ */\n.panel-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n  color: rgba(0, 0, 0, 0.85);\n}\n\n/* æ·»åŠ ä¸€çº§ç›®å½•æŒ‰é’® */\n.add-root-button {\n  padding: 5px 12px;\n  background-color: #fff;\n  color: #3949ab;\n  border: 1px solid #3949ab;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 13px;\n  height: 28px;\n  line-height: 18px;\n}\n\n.add-root-button:hover {\n  background-color: #3949ab10;\n}\n\n/* ç« èŠ‚æ ‘å®¹å™¨ */\n.chapter-tree-container {\n  flex: 1;\n  overflow-y: auto;\n  padding: 16px;\n}\n\n/* ç¼–è¾‘å™¨é¢æ¿ */\n.editor-panel {\n  flex: 1;\n  background-color: white;\n  border-radius: 2px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n}\n\n/* ç©ºç¼–è¾‘å™¨çŠ¶æ€ */\n.empty-editor {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  color: #888;\n}\n\n/* å–æ¶ˆæŒ‰é’® */\n.cancel-button {\n  padding: 6px 15px;\n  background-color: #f5f5f5;\n  color: rgba(0, 0, 0, 0.65);\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  height: 32px;\n  line-height: 20px;\n}\n\n.cancel-button:hover {\n  color: #3949ab;\n  border-color: #3949ab;\n}\n\n/* æ ‡é¢˜æ ·å¼ */\nh2 {\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 16px;\n  margin-bottom: 16px;\n  font-weight: 500;\n}\n\n/* é¢æ¿æ“ä½œåŒºåŸŸ */\n.panel-actions {\n  display: flex;\n  gap: 8px;\n}\n\n/* æ¨¡å¼åˆ‡æ¢æŒ‰é’® */\n.mode-toggle-button {\n  padding: 5px 12px;\n  background-color: #f5f5f5;\n  color: rgba(0, 0, 0, 0.65);\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 13px;\n  height: 28px;\n  line-height: 18px;\n}\n\n.mode-toggle-button:hover {\n  color: #3949ab;\n  border-color: #3949ab;\n}\n\n/* ç« èŠ‚ç¼–è¾‘å™¨ */\n.chapter-editor {\n  padding: 20px;\n  background-color: white;\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 40px); /* å‡å»å†…è¾¹è· */\n}\n\n/* ç¼–è¾‘å™¨æ ‡é¢˜ */\n.editor-header {\n  margin-bottom: 24px;\n  border-bottom: 1px solid #f0f0f0;\n  padding-bottom: 16px;\n}\n\n.editor-header h2 {\n  margin: 0;\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 16px;\n  font-weight: 500;\n}\n\n/* ç¼–è¾‘å™¨è¡¨å• */\n.editor-form {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  overflow: hidden; /* é˜²æ­¢å†…å®¹æº¢å‡º */\n}\n\n/* è¡¨å•å†…å®¹åŒºåŸŸ */\n.form-content {\n  flex: 1;\n  overflow-y: auto; /* åªæœ‰å†…å®¹åŒºæ»šåŠ¨ */\n  margin-bottom: 16px; /* ç»™åº•éƒ¨æŒ‰é’®ç•™ç©ºé—´ */\n}\n\n/* è¡¨å•ç»„ */\n.form-group {\n  width: 100%;\n  margin-bottom: 24px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: normal;\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 14px;\n  word-break: break-all;\n}\n\n/* è¾“å…¥æ¡†æ ·å¼ */\n.form-control {\n  width: calc(100% - 32px);\n  padding: 4px 11px;\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  font-size: 14px;\n  height: 32px;\n  line-height: 1.5;\n}\n\n.form-control:focus {\n  border-color: #40a9ff;\n  outline: none;\n  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);\n}\n\n/* é€‰æ‹©æ¡†åˆ—è¡¨ */\n.checkbox-list {\n  max-height: 300px;\n  overflow-y: auto;\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  padding: 8px 12px;\n}\n\n/* é€‰æ‹©æ¡†é¡¹ç›® */\n.checkbox-item {\n  padding: 8px 0;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.checkbox-item:last-child {\n  border-bottom: none;\n}\n\n/* é€‰æ‹©æ¡†æ ‡ç­¾ */\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.checkbox-label input {\n  margin-right: 8px;\n}\n\n/* è¡¨å•æ“ä½œåŒºåŸŸ */\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 8px;\n  /* ç§»é™¤ç»å¯¹å®šä½ï¼Œä½¿ç”¨å¸¸è§„æµå¸ƒå±€ */\n  margin-top: auto; /* æ¨åˆ°åº•éƒ¨ */\n}\n\n/* ä¿å­˜æŒ‰é’® */\n.save-button {\n  padding: 0 15px;\n  background-color: #3949ab;\n  color: white;\n  border: none;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  height: 32px;\n  line-height: 32px;\n}\n\n.save-button:hover {\n  background-color: #5c6bc0;\n}\n\n/* å–æ¶ˆæŒ‰é’® */\n.cancel-button {\n  padding: 0 15px;\n  background-color: #fff;\n  color: rgba(0, 0, 0, 0.65);\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  height: 32px;\n  line-height: 30px;\n}\n\n.cancel-button:hover {\n  color: #3949ab;\n  border-color: #3949ab;\n}\n\n/* ç« èŠ‚é¡¹ç›® */\n.chapter-item {\n  padding: 12px 15px;\n  background-color: white;\n  border: 1px solid #f0f0f0;\n  border-radius: 2px;\n  cursor: pointer;\n  transition: all 0.2s;\n  margin-bottom: 8px;\n}\n\n.chapter-item:hover {\n  background-color: #f9f9f9;\n}\n\n.chapter-item.selected {\n  background-color: #e6f7ff;\n  border-left: 3px solid #1890ff;\n}\n\n/* ç« èŠ‚å†…å®¹ */\n.chapter-content {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n/* ç« èŠ‚æ ‡é¢˜ */\n.chapter-title {\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 14px;\n}\n\n/* ç« èŠ‚æ“ä½œæŒ‰é’® */\n.chapter-actions {\n  display: flex;\n  gap: 8px;\n}\n\n/* ç« èŠ‚èµ„æºåˆ—è¡¨ */\n.chapter-resources {\n  margin-left: 30px;\n  padding: 5px 0;\n}\n\n/* èµ„æºåˆ—è¡¨ */\n.resource-list {\n  margin-bottom: 5px;\n}\n\n/* èµ„æºé¡¹ç›® */\n.resource-item {\n  padding: 6px 10px;\n  background-color: #f9f9f9;\n  border-radius: 3px;\n  margin-bottom: 4px;\n  font-size: 12px;\n  display: flex;\n  align-items: center;\n  color: #666;\n  transition: all 0.2s;\n  position: relative;\n  padding-left: 6px; /* ä¸ºæ ‡è®°ç•™å‡ºç©ºé—´ */\n}\n\n.resource-item:hover {\n  background-color: #f0f0f0;\n}\n\n/* èµ„æºç±»å‹æ ‡è®° */\n.resource-type-marker {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 4px;\n  height: 100%;\n  border-radius: 2px 0 0 2px;\n}\n\n/* èµ„æºæ ‡é¢˜ */\n.resource-title {\n  margin-left: 8px;\n  font-size: 12px;\n  line-height: 1.5;\n}\n\n/* ç§»é™¤ä¹‹å‰çš„æ ·å¼ */\n.attachment-item,\n.quiz-item {\n  border-left: none;\n}\n\n/* è¯¾ä»¶æ ‡ç­¾æ ·å¼ */\n.attachment-item::before {\n  content: \"è¯¾ä»¶\";\n  display: inline-block;\n  background-color: #22c55e;\n  color: #fff;\n  padding: 1px 6px;\n  border-radius: 2px;\n  font-size: 11px;\n  margin-right: 6px;\n  border: 1px solid transparent;\n  white-space: nowrap;\n}\n\n/* è€ƒé¢˜æ ‡ç­¾æ ·å¼ */\n.quiz-item::before {\n  content: \"è€ƒè¯•\";\n  display: inline-block;\n  background-color: #eba400;\n  color: #fff;\n  padding: 1px 6px;\n  border-radius: 2px;\n  font-size: 11px;\n  margin-right: 6px;\n  border: 1px solid transparent;\n}\n\n/* ä¸€çº§ç« èŠ‚ */\n.level-1 {\n  font-weight: 500;\n  background-color: #fafafa;\n  border-left: 3px solid #d9d9d9;\n}\n\n.level-1.selected {\n  border-left: 3px solid #1890ff;\n}\n\n/* äºŒçº§ç« èŠ‚ */\n.level-2 {\n  font-weight: normal;\n  background-color: #ffffff;\n  padding-left: 20px;\n  margin-left: 15px;\n  border-left: 3px solid #f0f0f0;\n}\n\n.level-2.selected {\n  border-left: 3px solid #52c41a;\n}\n\n/* æ·»åŠ å­ç« èŠ‚æŒ‰é’® */\n.add-sub-button {\n  background-color: #3949ab;\n  color: white;\n  border: none;\n  border-radius: 2px;\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.add-sub-button:hover {\n  background-color: #5c6bc0;\n}\n\n/* åˆ é™¤æŒ‰é’® */\n.delete-button {\n  background-color: #f5f5f5;\n  color: rgba(0, 0, 0, 0.65);\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  font-size: 12px;\n}\n\n.delete-button:hover {\n  color: #ff4d4f;\n  border-color: #ff4d4f;\n}\n\n/* ä¸€çº§ç« èŠ‚çš„èµ„æºåˆ—è¡¨æ ·å¼è°ƒæ•´ */\n.level-1-resources {\n  margin-left: 10px;\n  border-left: 3px solid #d9d9d9;\n  padding-left: 20px;\n}\n\n/* åªè¯»æ¨¡å¼ä¸‹çš„èµ„æºæ ·å¼ */\n.read-only-resources .resource-item {\n  cursor: default;\n}\n\n.read-only-resources .resource-item:hover {\n  background-color: #f9f9f9; /* ä¿æŒåŸèƒŒæ™¯è‰²ï¼Œä¸æ”¹å˜ */\n}\n\n/* ç« èŠ‚æ ‘æ ·å¼ */\n.chapter-tree {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n/* ç« èŠ‚ç»„æ ·å¼ */\n.chapter-group {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 5px;\n}\n\n/* å­ç« èŠ‚åŒºåŸŸæ ·å¼ */\n.sub-chapters {\n  margin-left: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding-top: 5px;\n  border-left: 1px dashed #d9d9d9;\n  margin-left: 10px;\n  padding-left: 20px;\n}\n\n/* åªè¯»æ¨¡å¼æ ·å¼ */\n.chapter-tree.read-only .chapter-item {\n  cursor: default;\n}\n\n.chapter-tree.read-only .chapter-item:hover {\n  background-color: transparent;\n}\n\n.chapter-item.read-only {\n  cursor: default;\n}\n\n.chapter-item.read-only:hover {\n  background-color: transparent;\n}\n\n.chapter-item.read-only.selected {\n  background-color: transparent;\n  font-weight: normal;\n  color: inherit;\n}\n\n.confirm-dialog-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.confirm-dialog {\n  background-color: white;\n  padding: 24px;\n  border-radius: 2px;\n  width: 320px;\n  box-shadow: 0 3px 6px -4px rgba(0, 0, 0, 0.12),\n    0 6px 16px 0 rgba(0, 0, 0, 0.08);\n}\n\n.confirm-dialog-title {\n  margin: 0 0 16px 0;\n  font-size: 16px;\n  color: rgba(0, 0, 0, 0.85);\n  font-weight: 500;\n}\n\n.confirm-dialog-message {\n  margin-bottom: 24px;\n  color: rgba(0, 0, 0, 0.65);\n  font-size: 14px;\n}\n\n.confirm-dialog-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 8px;\n}\n\n.confirm-dialog-cancel {\n  padding: 0 15px;\n  height: 32px;\n  line-height: 30px;\n  background-color: white;\n  border: 1px solid #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.65);\n}\n\n.confirm-dialog-cancel:hover {\n  color: #3949ab;\n  border-color: #3949ab;\n}\n\n.confirm-dialog-confirm {\n  padding: 0 15px;\n  height: 32px;\n  line-height: 32px;\n  background-color: #3949ab;\n  border: none;\n  border-radius: 2px;\n  cursor: pointer;\n  font-size: 14px;\n  color: white;\n}\n\n.confirm-dialog-confirm:hover {\n  background-color: #5c6bc0;\n}\n\n/* ç¦ç”¨çš„å¤šé€‰æ¡†æ ‡ç­¾æ ·å¼ */\n.checkbox-label.disabled {\n    color: #999;\n    cursor: not-allowed;\n}\n\n/* å·²è¢«ä½¿ç”¨æ ‡è®°çš„æ ·å¼ */\n.resource-used-mark {\n    margin-left: 5px;\n    font-size: 12px;\n    color: #ff6b6b;\n    font-style: italic;\n}\n\n/* ç« èŠ‚æ ‘ç©ºçŠ¶æ€æ ·å¼ */\n.chapter-tree-empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 40px 0;\n    color: #999;\n    text-align: center;\n}\n\n.empty-state-icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n    color: #d9d9d9;\n}\n\n.empty-state-text {\n    font-size: 16px;\n    margin-bottom: 8px;\n    color: #666;\n}\n\n.empty-state-hint {\n    font-size: 14px;\n    color: #999;\n}\n\n/* èµ„æºåˆ—è¡¨ç©ºçŠ¶æ€æ ·å¼ */\n.resource-empty-state {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    padding: 20px 0;\n    color: #999;\n    font-size: 14px;\n    background-color: #fafafa;\n    border-radius: 3px;\n}\n",
    "html": "<!-- no need to write html, head, body tags, it is handled by the widget -->\n<div id=\"root\"></div>\n",
    "js": "import React, { useState, useEffect } from \"https://esm.sh/react@18.2.0\";\nimport ReactDOM from \"https://esm.sh/react-dom@18.2.0\";\n\n// æ¨¡æ‹Ÿçš„å¯é€‰è€ƒé¢˜æ•°æ®\nconst AVAILABLE_QUIZZES = [\n\t{ id: 1, name: \"è€ƒé¢˜1ï¼šJavaåŸºç¡€çŸ¥è¯†æµ‹è¯•\" },\n\t{ id: 2, name: \"è€ƒé¢˜2ï¼šé¢å‘å¯¹è±¡æ¦‚å¿µç†è§£\" },\n\t{ id: 3, name: \"è€ƒé¢˜3ï¼šJavaè¯­æ³•ç»ƒä¹ \" },\n\t{ id: 4, name: \"è€ƒé¢˜4ï¼šç¼–ç¨‹å®è·µé¢˜\" },\n\t{ id: 5, name: \"è€ƒé¢˜5ï¼šç»¼åˆåº”ç”¨èƒ½åŠ›æµ‹è¯•\" },\n];\n\nfunction ConfirmDialog({ isOpen, name, message, onConfirm, onCancel }) {\n\tif (!isOpen) return null;\n\n\treturn (\n\t\t<div className=\"confirm-dialog-overlay\">\n\t\t<div className=\"confirm-dialog\">\n\t\t<h3 className=\"confirm-dialog-title\">{name}</h3>\n<p className=\"confirm-dialog-message\">{message}</p>\n<div className=\"confirm-dialog-actions\">\n\t<button className=\"confirm-dialog-cancel\" onClick={onCancel}>å–æ¶ˆ</button>\n<button className=\"confirm-dialog-confirm\" onClick={onConfirm}>ç¡®å®š</button>\n</div>\n</div>\n</div>\n);\n}\n\n// ç« èŠ‚é¡¹ç»„ä»¶\nfunction ChapterItem({\n\tchapter,\n\tselected,\n\tonSelect,\n\tonAddSubChapter,\n\tonDelete,\n\tlevel,\n\treadOnly = false // æ·»åŠ åªè¯»æ¨¡å¼å‚æ•°ï¼Œé»˜è®¤ä¸ºfalse\n}) {\n\t// æ·»åŠ çŠ¶æ€æ§åˆ¶ç¡®è®¤å¯¹è¯æ¡†æ˜¾ç¤º\n\tconst [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n\tconst [courseWare, setCourseWare] = useState(appsmith?.model?.courseWare ?? []);\n\n\t// å¤„ç†ç« èŠ‚é€‰æ‹©\n\tconst handleSelect = () => {\n\t\tif (!readOnly) {\n\t\t\tonSelect(chapter.id);\n\t\t}\n\t};\n\n\t// å¤„ç†æ·»åŠ å­ç« èŠ‚\n\tconst handleAddSubChapter = (e) => {\n\t\te.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œé¿å…è§¦å‘ç« èŠ‚é€‰æ‹©\n\t\tonAddSubChapter(chapter.id);\n\t};\n\n\t// å¤„ç†åˆ é™¤æŒ‰é’®ç‚¹å‡»\n\tconst handleDeleteClick = (e) => {\n\t\te.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡\n\t\tsetShowDeleteConfirm(true); // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†\n\t};\n\n\t// ç¡®è®¤åˆ é™¤\n\tconst confirmDelete = () => {\n\t\tsetShowDeleteConfirm(false);\n\t\tonDelete(chapter.id);\n\t};\n\n\t// å–æ¶ˆåˆ é™¤\n\tconst cancelDelete = () => {\n\t\tsetShowDeleteConfirm(false);\n\t};\n\n\t// æ ¼å¼åŒ–ç« èŠ‚æ ‡é¢˜\n\tconst formatTitle = () => {\n\t\t// å¯¹äºä¸€çº§ç« èŠ‚ï¼Œæ ¼å¼ä¸º\"ç¬¬Xç« \"\n\t\tif (level === 1) {\n\t\t\treturn `ç¬¬${chapter.sort}ç«  ${chapter.name}`;\n\t\t}\n\n\t\t// å¯¹äºäºŒçº§ç« èŠ‚ï¼Œæ ¼å¼ä¸º\"X.Y\"\n\t\treturn `${chapter.id} ${chapter.name}`;\n\t};\n\n\t// è¾…åŠ©å‡½æ•°ï¼šæ ¹æ®IDæŸ¥æ‰¾å¯¹åº”çš„è¯¾ä»¶åç§°\n\tconst getAttachmentName = (id) => {\n\t\tconst attachment = courseWare.find(a => a.id === id);\n\t\treturn attachment ? attachment.name : `æœªçŸ¥è¯¾ä»¶(${id})`;\n\t};\n\n\t// è¾…åŠ©å‡½æ•°ï¼šæ ¹æ®IDæŸ¥æ‰¾å¯¹åº”çš„è€ƒé¢˜åç§°\n\tconst getQuizName = (id) => {\n\t\tconst quiz = AVAILABLE_QUIZZES.find(q => q.id === id);\n\t\treturn quiz ? quiz.name : `æœªçŸ¥è€ƒé¢˜(${id})`;\n\t};\n\n\t// æ£€æŸ¥æ˜¯å¦æœ‰å…³è”çš„è¯¾ä»¶æˆ–è€ƒé¢˜\n\tconst hasAttachments = chapter.attachments && chapter.attachments.length > 0;\n\tconst hasQuizzes = chapter.quizzes && chapter.quizzes.length > 0;\n\n\tuseEffect(() => {\n\t\tappsmith.onModelChange((model, prevModel) => {\n\t\t\tif (JSON.stringify(model.courseWare) !== JSON.stringify(prevModel?.courseWare)) {\n\t\t\t\tsetCourseWare(model.courseWare ?? []);\n\t\t\t}\n\t\t})\n\t}, []);\n\n\n\treturn (\n\t\t<div>\n\t\t<div\n\t\tclassName={`chapter-item ${selected ? 'selected' : ''} level-${level} ${readOnly ? 'read-only' : ''}`}\n                onClick={handleSelect}\n            >\n                <div className=\"chapter-content\">\n                    <div className=\"chapter-name\">\n                        {/* ä½¿ç”¨é¢„å…ˆè®¡ç®—å¥½çš„æ˜¾ç¤ºæ ‡é¢˜ */}\n                        {chapter.displayTitle || formatTitle()}\n                    </div>\n                    {!readOnly && (\n                        <div className=\"chapter-actions\">\n                            {/* åªæœ‰ä¸€çº§ç« èŠ‚æ‰æ˜¾ç¤ºæ·»åŠ å­ç« èŠ‚æŒ‰é’® */}\n                            {level === 1 && (\n                                <button\n                                    className=\"add-sub-button\"\n                                    onClick={handleAddSubChapter}\n                                    title=\"æ·»åŠ äºŒçº§ç›®å½•\"\n                                >\n                                    +\n                                </button>\n                            )}\n                            <button\n                                className=\"delete-button\"\n                                onClick={handleDeleteClick}\n                                title=\"åˆ é™¤ç« èŠ‚\"\n                            >\n                                Ã—\n                            </button>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* æ˜¾ç¤ºå…³è”çš„è¯¾ä»¶æˆ–è€ƒé¢˜ */}\n            {(hasAttachments || hasQuizzes) && (\n                <div className={`chapter-resources ${level === 1 ? 'level-1-resources' : ''} ${readOnly ? 'read-only-resources' : ''}`}>\n                    {/* æ˜¾ç¤ºå…³è”çš„è¯¾ä»¶ */}\n                    {hasAttachments && (\n                        <div className=\"resource-list\">\n                            {chapter.attachments.map((attachmentId, index) => (\n                                <div key={`att-${index}`} className=\"resource-item attachment-item\">\n                                    <span className=\"resource-type-marker file-marker\"></span>\n                                    <span className=\"resource-title\">{getAttachmentName(attachmentId)}</span>\n                                </div>\n                            ))}\n                        </div>\n                    )}\n\n                    {/* æ˜¾ç¤ºå…³è”çš„è€ƒé¢˜ */}\n                    {hasQuizzes && (\n                        <div className=\"resource-list\">\n                            {chapter.quizzes.map((quizId, index) => (\n                                <div key={`quiz-${index}`} className=\"resource-item quiz-item\">\n                                    <span className=\"resource-type-marker quiz-marker\"></span>\n                                    <span className=\"resource-title\">{getQuizName(quizId)}</span>\n                                </div>\n                            ))}\n                        </div>\n                    )}\n                </div>\n            )}\n\n            {/* åˆ é™¤ç¡®è®¤å¯¹è¯æ¡† */}\n            <ConfirmDialog\n                isOpen={showDeleteConfirm}\n                title=\"åˆ é™¤ç¡®è®¤\"\n                message={`ç¡®å®šè¦åˆ é™¤\"${chapter.name}\"ç« èŠ‚å—ï¼Ÿ`}\n                onConfirm={confirmDelete}\n                onCancel={cancelDelete}\n            />\n        </div>\n    );\n}\n\n// ç« èŠ‚æ ‘ç»„ä»¶\nfunction ChapterTree({\n    chapters,\n    selectedChapterId,\n    onSelectChapter,\n    onAddSubChapter,\n    onDeleteChapter,\n    readOnly = false // æ·»åŠ åªè¯»æ¨¡å¼å‚æ•°ï¼Œé»˜è®¤ä¸ºfalse\n}) {\n    // è·å–é¡¶çº§ç« èŠ‚\n    const rootChapters = chapters.filter(chapter => !chapter.parentId);\n\n    // æ’åºé¡¶çº§ç« èŠ‚\n    const sortedRootChapters = [...rootChapters].sort((a, b) => a.sort - b.sort);\n\n    // è·å–å­ç« èŠ‚\n    const getChildChapters = (parentId) => {\n        return chapters\n            .filter(chapter => chapter.parentId === parentId)\n            .sort((a, b) => {\n                const aOrder = parseInt(a.id.split('.')[1]);\n                const bOrder = parseInt(b.id.split('.')[1]);\n                return aOrder - bOrder;\n            });\n    };\n\n    // å¦‚æœæ²¡æœ‰ä¸€çº§ç« èŠ‚ï¼Œæ˜¾ç¤ºç©ºçŠ¶æ€\n    if (sortedRootChapters.length === 0) {\n        return (\n            <div className=\"chapter-tree-empty-state\">\n                <div className=\"empty-state-icon\">ğŸ“š</div>\n                <div className=\"empty-state-text\">æš‚æ— ç« èŠ‚æ•°æ®</div>\n                {!readOnly && <div className=\"empty-state-hint\">ç‚¹å‡»\"æ·»åŠ ä¸€çº§ç›®å½•\"æŒ‰é’®åˆ›å»ºç« èŠ‚</div>}\n            </div>\n        );\n    }\n\n\n    // è‡ªå®šä¹‰ç« èŠ‚æ ‡é¢˜æ ¼å¼åŒ–å‡½æ•°\n    const formatChapterTitle = (chapter, index, parentIndex = null) => {\n        if (!parentIndex) {\n            // ä¸€çº§ç« èŠ‚ï¼šç¬¬Xç«  åç§°\n            return `ç¬¬${index}ç«  ${chapter.name}`;\n        } else {\n            // äºŒçº§ç« èŠ‚ï¼šX.Y åç§°\n            return `${parentIndex}.${index} ${chapter.name}`;\n        }\n    };\n\n    return (\n        <div className={`chapter-tree ${readOnly ? 'read-only' : ''}`}>\n               {sortedRootChapters.map((rootChapter, rootIndex) => {\n                const parentIndex = rootIndex + 1; // ä»1å¼€å§‹çš„çˆ¶ç« èŠ‚ç´¢å¼•\n\n                return (\n                    <div key={rootChapter.id} className=\"chapter-root\">\n                        <ChapterItem\n                            chapter={{\n                                ...rootChapter,\n                                displayTitle: formatChapterTitle(rootChapter, parentIndex)\n                            }}\n                            selected={selectedChapterId === rootChapter.id}\n                            onSelect={readOnly ? () => { } : onSelectChapter}\n                            onAddSubChapter={onAddSubChapter}\n                            onDelete={onDeleteChapter}\n                            level={1}\n                            readOnly={readOnly}\n                        />\n\n                   <div className=\"chapter-children\">\n                            {getChildChapters(rootChapter.id).map((childChapter, childIndex) => (\n                                <ChapterItem\n                                    key={childChapter.id}\n                                    chapter={{\n                                        ...childChapter,\n                                        displayTitle: formatChapterTitle(childChapter, childIndex + 1, parentIndex)\n                                    }}\n                                    selected={selectedChapterId === childChapter.id}\n                                    onSelect={readOnly ? () => { } : onSelectChapter}\n                                    onAddSubChapter={onAddSubChapter}\n                                    onDelete={onDeleteChapter}\n                                    level={2}\n                                    readOnly={readOnly}\n                                />\n                            ))}\n                        </div>\n                    </div>\n                );\n            })}\n        </div>\n    );\n}\n\nfunction ChapterTreePage() {\n    // ç« èŠ‚æ•°æ®çŠ¶æ€\n    const [chapters, setChapters] = useState(appsmith?.model?.chapters ?? []);\n\n    // å½“å‰é€‰ä¸­çš„ç« èŠ‚ID\n    const [selectedChapterId, setSelectedChapterId] = useState(null);\n    // æ˜¯å¦æ˜¾ç¤ºç¼–è¾‘å™¨\n    const [showEditor, setShowEditor] = useState(false);\n\n    useEffect(() => {\n        appsmith.onModelChange((model, prevModel) => {\n            if (JSON.stringify(model.chapters) !== JSON.stringify(prevModel?.chapters)) {\n                setChapters(model.chapters ?? []);\n            }\n        })\n    }, []);\n\n\n    // æ·»åŠ æ–°ç« èŠ‚\n    const addChapter = (parentId = null) => {\n        // å¦‚æœæ˜¯æ·»åŠ ä¸€çº§ç« èŠ‚\n        if (parentId === null) {\n            // è·å–å½“å‰æœ€å¤§çš„ä¸€çº§ç« èŠ‚æ•°é‡\n            const rootChapters = chapters.filter(c => c.parentId === null);\n            const newOrder = rootChapters.length + 1;\n            const newChapter = {\n                id: newOrder.toString(),\n                name: 'æ–°ç« èŠ‚åç§°',\n                sort: newOrder,\n                parentId: null,\n                attachments: [], // ç¡®ä¿åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„\n                quizzes: []      // ç¡®ä¿åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„\n            };\n            setChapters([...chapters, newChapter]);\n            appsmith.triggerEvent(\"handleSaveChapter\", { chapters: [...chapters, newChapter] })\n            setSelectedChapterId(newChapter.id);\n            // æ˜¾ç¤ºç¼–è¾‘å™¨\n            setShowEditor(true);\n        } else {\n            // å¦‚æœæ˜¯æ·»åŠ äºŒçº§ç« èŠ‚ï¼ˆå­ç« èŠ‚ï¼‰\n            // è·å–çˆ¶ç« èŠ‚\n            const parentChapter = chapters.find(c => c.id === parentId);\n            if (!parentChapter) return;\n\n            // è·å–è¯¥çˆ¶ç« èŠ‚ä¸‹çš„æ‰€æœ‰å­ç« èŠ‚\n            const childChapters = chapters.filter(c => c.parentId === parentId);\n            // è®¡ç®—æ–°å­ç« èŠ‚çš„é¡ºåº\n            const newChildOrder = childChapters.length + 1;\n            // åˆ›å»ºæ–°å­ç« èŠ‚\n            const newChildChapter = {\n                id: `${parentId}.${newChildOrder}`,\n                name: 'æ–°å°èŠ‚åç§°',\n                sort: newChildOrder,\n                parentId: parentId,\n                attachments: [], // ç¡®ä¿åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„\n                quizzes: []      // ç¡®ä¿åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„\n            };\n\n            setChapters([...chapters, newChildChapter]);\n            appsmith.triggerEvent(\"handleSaveChapter\", { chapters: [...chapters, newChildChapter] })\n            setSelectedChapterId(newChildChapter.id);\n            // æ˜¾ç¤ºç¼–è¾‘å™¨\n            setShowEditor(true);\n        }\n    };\n\n\n    // åˆ é™¤ç« èŠ‚\n    const deleteChapter = (chapterId) => {\n        // æ‰¾åˆ°è¦åˆ é™¤çš„ç« èŠ‚\n        const chapterToDelete = chapters.find(c => c.id === chapterId);\n        if (!chapterToDelete) return;\n\n        // å¦‚æœæ˜¯ä¸€çº§ç« èŠ‚ï¼ŒåŒæ—¶åˆ é™¤å…¶æ‰€æœ‰å­ç« èŠ‚\n        if (chapterToDelete.parentId === null) {\n            const updatedChapters = chapters.filter(\n                c => c.id !== chapterId && c.parentId !== chapterId\n            );\n\n            // é‡æ–°æ’åºå‰©ä½™çš„ä¸€çº§ç« èŠ‚\n            const rootChapters = updatedChapters\n                .filter(c => c.parentId === null)\n                .sort((a, b) => a.sort - b.sort);\n\n            // æ›´æ–°ä¸€çº§ç« èŠ‚çš„IDå’Œé¡ºåº\n            rootChapters.forEach((chapter, index) => {\n                const newOrder = index + 1;\n                const oldId = chapter.id;\n                chapter.id = newOrder.toString();\n                chapter.sort = newOrder;\n\n                // åŒæ—¶æ›´æ–°è¯¥ç« èŠ‚ä¸‹æ‰€æœ‰å­ç« èŠ‚çš„ID\n                updatedChapters\n                    .filter(c => c.parentId === oldId)\n                    .forEach(childChapter => {\n                        childChapter.parentId = chapter.id;\n                        childChapter.id = `${chapter.id}.${childChapter.sort}`;\n                    });\n            });\n\n            setChapters(updatedChapters);\n            appsmith.triggerEvent(\"handleSaveChapter\", { chapters: updatedChapters })\n\n            // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰é€‰ä¸­çš„ç« èŠ‚ï¼Œå–æ¶ˆé€‰ä¸­å¹¶éšè—ç¼–è¾‘å™¨\n            if (selectedChapterId === chapterId) {\n                setSelectedChapterId(null);\n                setShowEditor(false);\n            }\n        } else {\n            // å¦‚æœæ˜¯äºŒçº§ç« èŠ‚ï¼Œåªåˆ é™¤è¯¥ç« èŠ‚\n            const parentId = chapterToDelete.parentId;\n            const updatedChapters = chapters.filter(c => c.id !== chapterId);\n\n            // é‡æ–°æ’åºåŒä¸€çˆ¶ç« èŠ‚ä¸‹çš„æ‰€æœ‰å­ç« èŠ‚\n            const siblingChapters = updatedChapters\n                .filter(c => c.parentId === parentId)\n                .sort((a, b) => a.sort - b.sort);\n\n            // æ›´æ–°å­ç« èŠ‚çš„IDå’Œé¡ºåº\n            siblingChapters.forEach((chapter, index) => {\n                const newOrder = index + 1;\n                chapter.id = `${parentId}.${newOrder}`;\n                chapter.sort = newOrder;\n            });\n\n            setChapters(updatedChapters);\n            appsmith.triggerEvent(\"handleSaveChapter\", { chapters: updatedChapters })\n            // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰é€‰ä¸­çš„ç« èŠ‚ï¼Œé€‰æ‹©çˆ¶ç« èŠ‚\n            if (selectedChapterId === chapterId) {\n                setSelectedChapterId(parentId);\n            }\n        }\n    };\n\n    // é€‰ä¸­ç« èŠ‚\n    const selectChapter = (chapterId) => {\n        setSelectedChapterId(chapterId);\n        setShowEditor(true); // é€‰ä¸­ç« èŠ‚æ—¶æ˜¾ç¤ºç¼–è¾‘å™¨\n    };\n\n    return (\n        <div className=\"chapter-tree-page\">\n            <div className=\"app-main\">\n                <div className={`chapter-panel ${!showEditor ? 'full-width' : ''}`}>\n                    <div className=\"chapter-tree-container\">\n                        <ChapterTree\n                            chapters={chapters}\n                            selectedChapterId={selectedChapterId}\n                            onSelectChapter={selectChapter}\n                            onAddSubChapter={addChapter}\n                            onDeleteChapter={deleteChapter}\n                            readOnly={true} // æ ¹æ®æ¨¡å¼è®¾ç½®æ˜¯å¦åªè¯»\n                        />\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\n\n\nappsmith.onReady(() => {\n    /*\n         * This handler function will get called when parent application is ready.\n         * Initialize your component here\n         * more info - https://docs.appsmith.com/reference/widgets/custom#onready\n         */\n    ReactDOM.render(<ChapterTreePage />, document.getElementById(\"root\"));\n});"
  },
  "version": 1,
  "widgetId": "8gikfo5f7n",
  "widgetName": "CustomView"
}